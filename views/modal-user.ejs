<style>
    .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1050;
    }

    .modal-dialog {
        margin: 0;
        max-width: 500px;
        width: 90%;
    }

    .modal-content {
        box-shadow: 0 5px 15px rgba(0,0,0,.5);
    }

    body.modal-open {
        overflow: auto;
        padding-right: 0 !important;
    }
</style>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  class ModalManager {
    constructor() {
      this.modal = null;
    }

    initModal(modalElement) {
      this.modal = new bootstrap.Modal(modalElement, {
        backdrop: 'static',
        keyboard: false
      });
    }

    openModal(userData) {
      if (this.modal) {
        this.updateModalContent(userData);
        this.modal.show();
      } else {
        console.error('Modal not initialized');
      }
    }

    updateModalContent(userData) {
      const modalBody = document.querySelector('#memberInfoModal .modal-body');
      if (userData) {
        modalBody.innerHTML = `
        <form>
          <div class="mb-3">
            <label for="userId" class="form-label">아이디</label>
            <input type="text" class="form-control" id="userId" value="${userData.userId || ''}" readonly>
          </div>
          <!-- Add other form fields here -->
        </form>
        `;
        } else {
        modalBody.innerHTML = '<p>No user data available.</p>';
      }
    }
  }

  const modalManager = new ModalManager();

  document.addEventListener('DOMContentLoaded', () => {
    const memberInfoModal = document.getElementById('memberInfoModal');
    if (memberInfoModal) {
      modalManager.initModal(memberInfoModal);

      // Check if we should open the modal automatically
      const openModal = <%= openModal %>;
      const userData = <%- userData || 'null' %>;

      if (openModal && userData) {
        modalManager.openModal(userData);
      }
    }
  });
</script>

<!-- Modal structure -->
<div class="modal fade" id="memberInfoModal" tabindex="-1" aria-labelledby="memberInfoModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="memberInfoModalLabel">회원정보</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <!-- Modal content will be dynamically populated -->
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="button" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>
